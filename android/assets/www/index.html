<!doctype html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>index</title>

    <link rel="stylesheet" href="Scripts/jquery.ui.css" />

    <script type="text/javascript" language="javascript" src="cordova-2.5.0.js"></script>
    <script type="text/javascript" language="javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" language="javascript" src="Scripts/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" language="javascript" src="Scripts/jquery-ui.js"></script>

    <script>
        var iabRef = null;
        var googleAuthCode = null;

        function getGoogleAuthCode() {
            alert("native getGoogleAuthCode");
            return googleAuthCode;
        }

        var OAUTHURL    =   "https://accounts.google.com/o/oauth2/auth?";
        var VALIDURL    =   "https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=";
        var SCOPE       =   "https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email";
        var CLIENTID    =   "963091932519.apps.googleusercontent.com";
        //String REDIRECT    =   "http://localhost";//Window.Location.getPath();
        //var REDIRECT    =   "urn:ietf:wg:oauth:2.0:oob";//Window.Location.getPath();
        var REDIRECT    =   "http://localhost";


        var LOGOUT      =   "http://accounts.google.com/Logout";
        var TYPE        =   "code";
        var googleLoginUrl =   OAUTHURL + "scope=" + SCOPE + "&client_id=" + CLIENTID + "&redirect_uri=" + REDIRECT + "&response_type=" + TYPE;
        var acToken;
        var tokenType;
        var expiresIn;
        var user;
        var loggedIn    =   false;

        function doGoogleForOauth(name) {
            <!--alert("Hello from JavaScript, " + name);-->

            try {
                iabRef = window.open(googleLoginUrl, "_blank", "location=no");
                //iabRef.addEventListener('loadstart', onLoadStart);
                iabRef.addEventListener('loadstop', onLoadStop);
                iabRef.addEventListener('exit', onExit);

            } catch (e) {
                alert("exception"+e);
            }
        }

        function onLoadStart(event) {
            <!--alert(event.type + ' - ' + event.url);-->
        }

        function onLoadStop(event) {
            //alert(event.type + ' - ' + event.url);
            //if(event.url == "http://pagethatuwant1/closeInAppBrowser.html"){
            if(/^http:\/\/localhost/i.test(event.url)) {

                var secondPos = event.url.indexOf("code=");
                <!--alert("secondPos="+secondPos+", length="+event.url.length);-->
                googleAuthCode = event.url.substring(secondPos+"code=".length, event.url.length);
                alert("woot="+ googleAuthCode);

                <!--tokenType = gup(event.url, 'token_type');-->
                <!--expiresIn = gup(event.url, 'expires_in');-->

                <!--alert("event.url("+event.url+"),"+-->
                      <!--"acToken("+acToken+"),"+-->
                      <!--"tokenType("+tokenType+"),"+-->
                      <!--"code("+googleCode+")");-->

                iabRef.close();
            } else {
                <!--alert(event.url);-->
            }
        }

        function onExit(event) {
            <!--alert(event.type);-->
            if (iabRef) {
                iabRef.removeEventListener('loadstart', onLoadStart);
                iabRef.removeEventListener('loadstop', onLoadStop);
                iabRef.removeEventListener('exit', onExit);
                iabRef = null;
            }
        }


    </script>


    <script type="text/javascript" language="javascript" src="showcase/showcase.nocache.js"></script>



</head>

<body>


<iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1'
        style="position:absolute;width:0;height:0;border:0"></iframe>

</body>
</html>